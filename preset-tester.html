<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Preset Tester</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Consolas', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            height: 100vh;
        }

        .header {
            background: #2d2d30;
            padding: 15px;
            border-bottom: 1px solid #3e3e42;
            text-align: center;
        }

        .header h1 {
            color: #4fc3f7;
            margin-bottom: 10px;
        }

        .quick-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preset-btn {
            background: #0e639c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin: 2px;
        }

        .preset-btn:hover {
            background: #1177bb;
        }

        .preset-btn.active {
            background: #16825d;
        }

        .container {
            display: flex;
            height: calc(100vh - 120px);
        }

        .yaml-panel {
            width: 50%;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #3e3e42;
        }

        .preview-panel {
            width: 50%;
            background: #000;
            color: #4fc3f7;
            padding: 20px;
            overflow-y: auto;
        }

        .yaml-editor {
            flex: 1;
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            border: none;
            outline: none;
            padding: 15px;
            resize: none;
            line-height: 1.5;
        }

        .yaml-header {
            background: #252526;
            padding: 10px 15px;
            border-bottom: 1px solid #3e3e42;
            font-weight: bold;
        }

        .preview-header {
            color: #4fc3f7;
            font-size: 18px;
            margin-bottom: 20px;
            text-align: center;
        }

        .structure-tree {
            font-family: monospace;
            line-height: 1.6;
        }

        .tree-node {
            margin-left: 20px;
            color: #d4d4d4;
        }

        .tree-terrain { color: #8bc34a; }
        .tree-object { color: #ff9800; }
        .tree-persona { color: #e91e63; }
        .tree-portal { color: #9c27b0; }
        .tree-preset { color: #00bcd4; font-weight: bold; }

        .validation {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
        }

        .validation.success {
            background: #1b5e20;
            border: 1px solid #4caf50;
        }

        .validation.error {
            background: #b71c1c;
            border: 1px solid #f44336;
        }

        .preset-info {
            background: #1a237e;
            border: 1px solid #3f51b5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .preset-info h4 {
            color: #7986cb;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ Quick Preset Tester</h1>
        <div class="quick-controls">
            <button class="preset-btn" data-preset="terrain">üåç Terrain Presets</button>
            <button class="preset-btn" data-preset="objects">üì¶ Object Presets</button>
            <button class="preset-btn" data-preset="personas">üë§ Persona Presets</button>
            <button class="preset-btn" data-preset="complete">üé¨ Komplette Szene</button>
            <button class="preset-btn" data-preset="custom">‚úèÔ∏è Custom YAML</button>
        </div>
    </div>

    <div class="container">
        <div class="yaml-panel">
            <div class="yaml-header">üìù YAML Code</div>
            <textarea class="yaml-editor" id="yamlEditor" placeholder="# W√§hle einen Preset-Test aus den Buttons oben..."></textarea>
        </div>

        <div class="preview-panel">
            <div class="preview-header">üîç Struktur-Analyse</div>
            <div id="structurePreview">
                <div style="text-align: center; color: #666; margin-top: 50px;">
                    W√§hle einen Preset-Test um die Struktur zu sehen...
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script>
        class QuickPresetTester {
            constructor() {
                this.yamlEditor = document.getElementById('yamlEditor');
                this.structurePreview = document.getElementById('structurePreview');
                
                this.setupEventListeners();
                this.initializeTemplates();
            }

            initializeTemplates() {
                this.templates = {
                    terrain: `# Test verschiedener Terrain-Presets
name: "Terrain Preset Test"
id: "terrain-test"

environment:
  ambient_light: 0.6
  sun_intensity: 0.8

# Teste forest_floor Preset
terrain:
  preset: "forest_floor"
  size: [40, 40]  # √úberschreibt Preset-Gr√∂√üe

# Alternativ teste andere Terrain-Presets:
# terrain:
#   preset: "grass_flat"
# terrain:
#   preset: "marble_flat"`,

                    objects: `# Test verschiedener Object-Presets
name: "Object Preset Test"
id: "object-test"

environment:
  ambient_light: 0.6

terrain:
  preset: "grass_flat"
  size: [30, 30]

objects:
  # Alle verf√ºgbaren Object-Presets testen:
  
  - preset: "tree_simple"
    position: [5, 0, 5]
    # Preset liefert: scale: [2, 2.5, 2], color: "#1a4a1a"
    
  - preset: "rock_small"
    position: [-5, 0, 5]
    scale: [1.5, 1.5, 1.5]  # √úberschreibt Preset
    
  - preset: "mushroom_small"
    position: [0, 0, -5]
    interactive: true
    
  - preset: "stone_circle_thin"
    position: [0, 0, 0]
    
  - preset: "crystal"
    position: [5, 0, -5]
    
  - preset: "bookshelf"
    position: [-5, 0, -5]`,

                    personas: `# Test verschiedener Persona-Presets
name: "Persona Preset Test"
id: "persona-test"

environment:
  ambient_light: 0.7

terrain:
  preset: "grass_flat"
  size: [25, 25]

personas:
  # Alle verf√ºgbaren Persona-Presets:
  
  - preset: "npc_plain"
    name: "Standard NPC"
    position: [5, 0, 5]
    # Preset: color: "#ff6b6b", height: 1.4
    
  - preset: "npc_fairy"
    name: "Fee Luminara"
    position: [-5, 0, 5]
    # Preset: kleine Fee mit speziellen Eigenschaften
    
  - preset: "npc_scholar"
    name: "Gelehrter Magnus"
    position: [0, 0, -5]
    # Preset: Bibliotheks-NPC
    
  - preset: "npc_guardian"
    name: "W√§chter Theron"
    position: [5, 0, -5]
    # Preset: Gro√üer W√§chter-NPC`,

                    complete: `# Komplette Szene mit allen Preset-Typen
name: "Vollst√§ndiger Preset Test"
description: "Zeigt alle Preset-Kategorien zusammen"
id: "complete-test"

environment:
  skybox: "twilight"
  ambient_light: 0.5
  sun_intensity: 0.7
  fog_distance: 50

# Terrain mit Preset
terrain:
  preset: "forest_floor"
  size: [50, 50]

# Diverse Objekte mit Presets
objects:
  - preset: "tree_simple"
    position: [8, 0, 8]
    
  - preset: "tree_simple"
    position: [-8, 0, 8]
    scale: [1.5, 2, 1.5]
    
  - preset: "mushroom_small"
    position: [3, 0, -3]
    interactive: true
    
  - preset: "stone_circle_thin"
    position: [0, 0, 0]
    
  - preset: "crystal"
    position: [-8, 0, -8]

# NPCs mit verschiedenen Presets
personas:
  - preset: "npc_guardian"
    name: "Waldw√§chter"
    position: [-5, 0, 10]
    
  - preset: "npc_fairy"
    name: "Glitzerfee"
    position: [5, 0, -10]

# Portale f√ºr Navigation
portals:
  - id: "exit"
    name: "Ausgang"
    position: [15, 1, 0]
    destination: "zone-start"
    color: "#32cd32"`,

                    custom: `# Hier kannst du dein eigenes YAML testen
name: "Meine Test-Welt"
description: "Experimentiere mit Presets!"
id: "custom-test"

environment:
  ambient_light: 0.6
  sun_intensity: 0.8

# W√§hle ein Terrain-Preset:
terrain:
  preset: "grass_flat"  # oder "forest_floor" oder "marble_flat"

# F√ºge Objekte hinzu:
objects:
  - preset: "tree_simple"
    position: [0, 0, 0]
    # Weitere Eigenschaften hier...

# F√ºge NPCs hinzu:
personas:
  - preset: "npc_plain"
    name: "Mein NPC"
    position: [3, 0, 3]
    # Weitere Eigenschaften hier...`
                };
            }

            setupEventListeners() {
                // Preset-Button Klicks
                document.querySelectorAll('.preset-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        // Active state
                        document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        
                        // Load template
                        const preset = e.target.dataset.preset;
                        this.loadPreset(preset);
                    });
                });

                // YAML Editor Input
                this.yamlEditor.addEventListener('input', () => {
                    this.analyzeYAML();
                });
            }

            loadPreset(presetType) {
                if (this.templates[presetType]) {
                    this.yamlEditor.value = this.templates[presetType];
                    this.analyzeYAML();
                }
            }

            analyzeYAML() {
                const yamlText = this.yamlEditor.value.trim();
                if (!yamlText) {
                    this.structurePreview.innerHTML = '<div style="text-align: center; color: #666;">Noch kein YAML-Code...</div>';
                    return;
                }

                try {
                    const data = jsyaml.load(yamlText);
                    this.displayStructure(data);
                } catch (error) {
                    this.displayError(error.message);
                }
            }

            displayStructure(data) {
                let html = '';
                
                // Header
                html += `<div class="validation success">‚úÖ YAML ist valide</div>`;
                
                // World Info
                html += `<div class="preset-info">`;
                html += `<h4>üåç Welt-Info</h4>`;
                html += `<div>Name: ${data.name || 'Unbenannt'}</div>`;
                html += `<div>ID: ${data.id || 'Keine ID'}</div>`;
                if (data.description) html += `<div>Beschreibung: ${data.description}</div>`;
                html += `</div>`;

                // Structure Tree
                html += `<div class="structure-tree">`;
                html += `<div style="color: #4fc3f7; font-weight: bold; margin-bottom: 10px;">üìä Struktur-Analyse:</div>`;

                // Terrain
                if (data.terrain) {
                    html += `<div class="tree-terrain">üåç Terrain:</div>`;
                    if (data.terrain.preset) {
                        html += `<div class="tree-node tree-preset">preset: "${data.terrain.preset}"</div>`;
                    }
                    if (data.terrain.type) {
                        html += `<div class="tree-node">type: ${data.terrain.type}</div>`;
                    }
                    if (data.terrain.size) {
                        html += `<div class="tree-node">size: [${data.terrain.size.join(', ')}]</div>`;
                    }
                }

                // Objects
                if (data.objects && data.objects.length > 0) {
                    html += `<div class="tree-object">üì¶ Objekte (${data.objects.length}):</div>`;
                    data.objects.forEach((obj, i) => {
                        if (obj.preset) {
                            html += `<div class="tree-node tree-preset">[${i}] preset: "${obj.preset}"</div>`;
                        } else if (obj.type) {
                            html += `<div class="tree-node">[${i}] type: ${obj.type}</div>`;
                        }
                        if (obj.position) {
                            html += `<div class="tree-node" style="margin-left: 40px;">position: [${obj.position.join(', ')}]</div>`;
                        }
                    });
                }

                // Personas
                if (data.personas && data.personas.length > 0) {
                    html += `<div class="tree-persona">üë§ NPCs (${data.personas.length}):</div>`;
                    data.personas.forEach((npc, i) => {
                        if (npc.preset) {
                            html += `<div class="tree-node tree-preset">[${i}] preset: "${npc.preset}"</div>`;
                        }
                        if (npc.name) {
                            html += `<div class="tree-node" style="margin-left: 40px;">name: "${npc.name}"</div>`;
                        }
                        if (npc.position) {
                            html += `<div class="tree-node" style="margin-left: 40px;">position: [${npc.position.join(', ')}]</div>`;
                        }
                    });
                }

                // Portals
                if (data.portals && data.portals.length > 0) {
                    html += `<div class="tree-portal">üö™ Portale (${data.portals.length}):</div>`;
                    data.portals.forEach((portal, i) => {
                        html += `<div class="tree-node">[${i}] ${portal.name || portal.id}</div>`;
                        if (portal.destination) {
                            html += `<div class="tree-node" style="margin-left: 40px;">‚Üí ${portal.destination}</div>`;
                        }
                    });
                }

                html += `</div>`;

                // Preset Usage Analysis
                const presetUsage = this.analyzePresetUsage(data);
                if (presetUsage.length > 0) {
                    html += `<div class="preset-info">`;
                    html += `<h4>üéØ Verwendete Presets</h4>`;
                    presetUsage.forEach(preset => {
                        html += `<div>‚Ä¢ ${preset}</div>`;
                    });
                    html += `</div>`;
                }

                this.structurePreview.innerHTML = html;
            }

            analyzePresetUsage(data) {
                const presets = [];
                
                if (data.terrain?.preset) presets.push(`Terrain: ${data.terrain.preset}`);
                
                if (data.objects) {
                    data.objects.forEach(obj => {
                        if (obj.preset) presets.push(`Object: ${obj.preset}`);
                    });
                }
                
                if (data.personas) {
                    data.personas.forEach(npc => {
                        if (npc.preset) presets.push(`Persona: ${npc.preset}`);
                    });
                }
                
                return presets;
            }

            displayError(message) {
                this.structurePreview.innerHTML = `
                    <div class="validation error">
                        ‚ùå YAML Fehler:<br>
                        ${message}
                    </div>
                    <div style="margin-top: 20px; color: #888;">
                        Pr√ºfe die Syntax und versuche es erneut.
                    </div>
                `;
            }
        }

        // Initialize when page loads
        window.addEventListener('load', () => {
            new QuickPresetTester();
        });
    </script>
</body>
</html>
