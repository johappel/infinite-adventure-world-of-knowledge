:root{
  --bg:#0b0f14;
  --panel:#121922;
  --panel-2:#0f1620;
  --ink:#d8e7ff;
  --ink-dim:#a9bfdc;
  --accent:#6ee7ff;
  --accent-2:#8bffb0;
  --warn:#ffd36e;
  --muted:#2a3a4d;
}

html,body{
  height:100%;
  margin:0;
  background:radial-gradient(1200px 800px at 70% -10%, #0f2035, var(--bg));
  color:var(--ink);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  overflow:hidden;
}

/* Header */
header{
  position:fixed; inset:0 0 auto 0; height:64px; display:flex; align-items:center; gap:14px;
  padding:10px 16px; background:linear-gradient(180deg, rgba(8,14,22,.9), rgba(8,14,22,.6) 60%, transparent);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
  z-index:10;
  border-bottom:1px solid rgba(255,255,255,.06);
}

.brand{
  display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.3px;
}

.brand .logo{
  width:28px; height:28px; border-radius:7px;
  background: conic-gradient(from 220deg, var(--accent), #9aa7ff, #8bffb0, var(--accent));
  box-shadow: 0 0 16px rgba(110,231,255,.35);
}

.pill{
  padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08);
  color:var(--ink-dim); font-size:12px;
}

.toolbar{ 
  margin-left:auto; display:flex; align-items:center; gap:8px; 
}

.toolbar button, .toolbar select{
  background:var(--panel); color:var(--ink); border:1px solid rgba(255,255,255,.08);
  padding:8px 10px; border-radius:8px; font-size:12px; cursor:pointer;
}

.toolbar button:hover{ 
  border-color: rgba(110,231,255,.6); 
  box-shadow: 0 0 0 3px rgba(110,231,255,.12) inset; 
}

/* YAML World Buttons */
.toolbar button[id^="yaml"] {
  background: linear-gradient(135deg, var(--panel), rgba(110,231,255,.1));
  border-color: rgba(110,231,255,.3);
}

.toolbar button[id^="yaml"]:hover {
  background: linear-gradient(135deg, rgba(110,231,255,.15), rgba(110,231,255,.25));
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(110,231,255,.2) inset;
}

/* Main Layout */
main{
  position:fixed; inset:64px 340px 160px 0; display:grid; grid-template-columns:1fr;
  grid-template-rows: 1fr;
}

#viewport{
  position:relative; width:100%; height:100%; background: radial-gradient(600px 400px at 50% 60%, rgba(36,64,96,.25), transparent);
  border-top-right-radius: 12px; border-bottom-right-radius: 12px; overflow:hidden;
  border-right:1px solid rgba(255,255,255,.06);
}

#hud{
  position:absolute; inset:auto 14px 14px auto; display:flex; gap:8px;
}

.hud-pill{ 
  background:rgba(0,0,0,.35); padding:6px 10px; border-radius:999px; 
  border:1px solid rgba(255,255,255,.12); font-size:12px; color:var(--ink-dim); 
}

aside{
  position:fixed; inset:64px 0 160px auto; width:340px; display:flex; flex-direction:column; gap:10px; padding:10px;
  background:linear-gradient(180deg, rgba(12,18,26,.8), rgba(12,18,26,.6));
  border-left:1px solid rgba(255,255,255,.06);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
}

.panel{
  background: var(--panel-2);
  border:1px solid rgba(255,255,255,.08);
  border-radius:12px;
  padding:10px;
}

.panel h3{ 
  margin:0 0 8px 0; font-size:13px; color:var(--ink); letter-spacing:.3px; 
}

#zones, #personas{ 
  display:flex; flex-wrap:wrap; gap:8px; 
}

.chip{
  background: rgba(255,255,255,.06);
  padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.08);
  font-size:12px; cursor:pointer; color:var(--ink);
}

.chip:hover{ 
  border-color: rgba(139,255,176,.7); 
  box-shadow: 0 0 0 3px rgba(139,255,176,.12) inset; 
}

#log{
  height:160px; overflow:auto; 
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px; line-height:1.45; color:var(--ink-dim);
  background: #0b1220; border-radius:10px; border:1px solid rgba(255,255,255,.08);
  padding:8px;
}
footer{
  position:fixed; inset:auto 0 0 0; height:160px; display:grid; grid-template-columns: 1fr 360px;
  gap:10px; padding:10px; background:linear-gradient(180deg, rgba(8,14,22,.0), rgba(8,14,22,.85) 30%, rgba(8,14,22,.95));
  border-top:1px solid rgba(255,255,255,.06);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
}

.dialog{
  background: var(--panel-2); border:1px solid rgba(255,255,255,.08); border-radius:12px; 
  display:flex; flex-direction:column; overflow:hidden;
}

.dialog-header{
  display:flex; align-items:center; gap:10px; padding:8px 10px; 
  background: rgba(255,255,255,.04); border-bottom:1px solid rgba(255,255,255,.06);
  font-size:13px;
}

.dialog-body{ 
  flex:1; overflow:auto; padding:10px; display:flex; flex-direction:column; gap:8px; 
}

.bubble{ 
  max-width:80%; padding:8px 10px; border-radius:10px; border:1px solid rgba(255,255,255,.08); 
}

.bubble.user{ 
  align-self:flex-end; background:rgba(110,231,255,.08); border-color: rgba(110,231,255,.3); 
}

.bubble.npc{ 
  align-self:flex-start; background:rgba(255,255,255,.04); 
}

.dialog-input{ 
  display:flex; gap:8px; padding:8px; border-top:1px solid rgba(255,255,255,.06); 
}

.dialog-input input{
  flex:1; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12); 
  background:#0b1220; color:var(--ink);
}

.dialog-input button{
  padding:10px 14px; border-radius:10px; border:1px solid rgba(255,255,255,.12); 
  background:var(--panel); color:var(--ink); cursor:pointer;
}

.refs{
  background: var(--panel-2); border:1px solid rgba(255,255,255,.08); border-radius:12px; 
  overflow:auto; padding:10px;
  font-size:12px; color:var(--ink-dim);
}

.refs a{ 
  color: var(--accent); text-decoration: none; 
}

.refs a:hover{ 
  text-decoration: underline; 
}

.kbd{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:11px; background:#0b1220; border:1px solid rgba(255,255,255,.12); 
  border-bottom-width:2px; border-radius:6px; padding:1px 6px;
  color:var(--ink);
}

/* Loading overlay */
#loading{
  position:absolute; inset:0; display:none; align-items:center; justify-content:center;
  background: radial-gradient(800px 600px at 50% 50%, rgba(20,30,45,.55), rgba(12,18,26,.85));
  z-index:5;
}

.spin{
  width:24px; height:24px; border-radius:50%;
  border:3px solid rgba(255,255,255,.15); border-top-color: var(--accent);
  animation: rot 1s linear infinite;
}

@keyframes rot{ 
  to { transform: rotate(360deg); } 
}

/* Scrollbars */
*{ 
  scrollbar-width: thin; scrollbar-color: #3a4a60 transparent; 
}

*::-webkit-scrollbar{ 
  height:10px; width:10px; 
}

*::-webkit-scrollbar-thumb{ 
  background:#3a4a60; border-radius:10px; 
}

*::-webkit-scrollbar-track{ 
  background: transparent; 
}
